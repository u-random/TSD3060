<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
            <title>Main form page</title>
            <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body onload="doInit()">
        <h3 id="loginstatus" style="text-align: right; margin: 20px;"></h3>
        <center>
            <!--@status-->
            <!--LOGIN.-->
            <h1>Login box</h1>
            <form id="loginform" action="http://192.168.10.200:8180/login" method='post'>
                <label for="email">Username:</label><br>
                <input type="text" id="email" name="email"><br>
                <label for="password">Password:</label><br>
                <input type="password" id="password" name="password"><br>
                <input type="submit" value="Login" >
            </form>

            <!--Log out-->
            <hr>
            <h1>Logout box</h1>
            <form action="http://192.168.10.200:8180/logout" method='post'>
                <input type="submit" value="Logout">
                    </form>
            
            <!--Get dikt, one or all.-->
            <hr>
            <h1>Get Dikts</h1>
            <p>Type ID number. Leave empty to get all dikts</p>
            <form action="http://192.168.10.200:8180/dikt/get" method='post'>
                <label for="diktID">DiktID:</label><br>
                <input type="text" id="diktID" name="diktID"><br>
                    <input type="submit" value="Get dikts">
                        </form>
            
            <!--ADD dikt.-->
            <hr>
            <h1>Add Dikts here</h1>
            <form action="http://192.168.10.200:8180/dikt/add" method='post'>
                <label for="title">Title:</label><br>
                <input type="text" id="title" name="title"><br>
                    <input type="submit" value="ADD new dikt">
                        </form>
            <!--Edit dikt.-->
            <hr>
            <h1>Edit Dikts here</h1>
            <p>Supply dikt id and new title</p>
            <form action="http://192.168.10.200:8180/dikt/edit" method='post'>
                <label for="labelEditDiktId">Dikt ID:</label><br>
                <input type="text" id="labelEditDiktId" name="diktID"><br>
                    <label for="labelEditDiktTitle">Title:</label><br>
                    <input type="text" id="labelEditDiktTitle" name="title"><br>
                    <input type="submit" value="Edit dikt">
            </form>
            <!--DELETE dikt, one or all.-->
            <hr>
            <h1>Delete Dikts here</h1>
            <p>Only diktID needed. No warning provided.</p>
            <form action="http://192.168.10.200:8180/dikt/delete" method='post'>
                <label for="labelDeleteDiktId">Dikt ID:</label><br>
                <input type="text" id="labelDeleteDiktId" name="diktID"><br>
                    <input type="submit" value="Delete dikt">
                        </form>
            <hr>
            <h1>Surprise</h1>
            <a href="surprise.asis">Surprise NOW!</a>
            <hr>
            <h1>Homepage</h1>
            <a href="index.html">Go home</a>
        </center>
<!--        <script src="web-application.js"></script>-->

        <script type="application/ecmascript">
            // Helpers
            function getCookie(cname) {
                let name = cname + "=";
                let ca = document.cookie.split(';');
                for(let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                        return c.substring(name.length, c.length);
                    }
                }
                return "";
            }

            document.getElementById('loginform').addEventListener('submit', function(event) {
                event.preventDefault();
                let formData = new FormData(this);
                // Process formData to XML
            });

            //use the form data to construct the XML request body
            function constructLoginXML(formData) {
                let email = formData.get('email');
                let password = formData.get('password');
                return `<login><email>${email}</email><password>${password}</password></login>`;
            }


            function sendLoginRequest(xmlData) {
                fetch('restapi/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/xml; charset=UTF-8'
                    },
                    body: xmlData
                })
                    .then(response => response.text())
                    .then(data => {
                        // Handle the response data
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            }

            function doInit() {
                setLoginStatus()
            }
            function setLoginStatus() {
                var status = "Not logged in"
                if (getCookie("session_id")) {
                    status="You are logged in"
                }
                document.getElementById('loginstatus').textContent = status
            }
        </script>
    </body>
</html>

